~version: "2.0"

### STEP 1: Define which pages get Instant View and which don't

?exists: /html/head/meta[@name="typlog"]

### STEP 2: Define the essential elements

body: //div[has-class("entry-content")]
title: //h1[has-class("entry-title")]

subtitle: //div[has-class("entry-headline")]
subtitle: //h2[has-class("entry-headline")]

channel: /html/head/meta[@name="telegram:channel"]/@content

published_date: //time[@itemprop="datePublished"]

author: //span[@itemprop="author"]
author: //strong[@itemprop="author"]
author: //div[@itemprop="author"]

# Find cover element
@background_to_image: //div[has-class("entry-cover")]
cover: $@
@background_to_image: //aside[has-class("entry-cover")]
cover: $@

# If we've already got a cover, we'll use it for the link preview image too.
image_url: $cover/self::img/@src
image_url: $cover/self::figure//img/@src

# If we didn't find a cover, we'll take a picture from the meta tags. 
# Otherwise, the link preview will just have text in it, which is also OK.
image_url: //head/meta[@property="og:image"]/@content

@set_attrs(src, @data-src): $body//img
